<% if (typeof user !=='undefined' && user && typeof userRole !=='undefined' ) { %>
    <!-- FAB Menu -->
    <div class="fixed bottom-6 right-6 z-[1000] flex flex-col items-end gap-4">
        <!-- Backdrop -->
        <div class="fixed inset-0 bg-gray-900/60 backdrop-blur-sm opacity-0 invisible transition-all duration-300 z-[999]"
            id="fabBackdrop"></div>

        <!-- Mini FABs -->
        <div class="flex flex-col items-end gap-3 mb-2 invisible transition-all duration-300 transform translate-y-10 opacity-0 z-[1000]"
            id="fabMenu">
            <% if (userRole==='sysadmin' ) { %>
                <a href="/sysadmin/users"
                    class="flex items-center gap-3 bg-white hover:bg-indigo-600 text-indigo-600 hover:text-white px-5 py-3 rounded-2xl shadow-xl transition-all font-bold group">
                    <span class="text-sm">Users</span>
                    <i data-lucide="user-plus" class="w-5 h-5"></i>
                </a>
                <a href="/sysadmin/products"
                    class="flex items-center gap-3 bg-white hover:bg-indigo-600 text-indigo-600 hover:text-white px-5 py-3 rounded-2xl shadow-xl transition-all font-bold group">
                    <span class="text-sm">Products</span>
                    <i data-lucide="package" class="w-5 h-5"></i>
                </a>
                <a href="/sysadmin/dashboard"
                    class="flex items-center gap-3 bg-white hover:bg-indigo-600 text-indigo-600 hover:text-white px-5 py-3 rounded-2xl shadow-xl transition-all font-bold group">
                    <span class="text-sm">Dashboard</span>
                    <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
                </a>
                <% } else if (userRole==='salesperson' ) { %>
                    <a href="/salesperson/reminders"
                        class="flex items-center gap-3 bg-white hover:bg-amber-500 text-amber-600 hover:text-white px-5 py-3 rounded-2xl shadow-xl transition-all font-bold group">
                        <span class="text-sm">Reminders</span>
                        <i data-lucide="bell" class="w-5 h-5"></i>
                    </a>
                    <a href="/salesperson/create-order"
                        class="flex items-center gap-3 bg-white hover:bg-indigo-600 text-indigo-600 hover:text-white px-5 py-3 rounded-2xl shadow-xl transition-all font-bold group">
                        <span class="text-sm">New Order</span>
                        <i data-lucide="plus-circle" class="w-5 h-5"></i>
                    </a>
                    <a href="/salesperson/orders"
                        class="flex items-center gap-3 bg-white hover:bg-indigo-600 text-indigo-600 hover:text-white px-5 py-3 rounded-2xl shadow-xl transition-all font-bold group">
                        <span class="text-sm">My Orders</span>
                        <i data-lucide="list" class="w-5 h-5"></i>
                    </a>
                    <a href="/salesperson/dashboard"
                        class="flex items-center gap-3 bg-white hover:bg-indigo-600 text-indigo-600 hover:text-white px-5 py-3 rounded-2xl shadow-xl transition-all font-bold group">
                        <span class="text-sm">Dashboard</span>
                        <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
                    </a>
                    <% } else if (userRole==='sales_head' ) { %>
                        <a href="/sales-head/pending-orders"
                            class="flex items-center gap-3 bg-white hover:bg-indigo-600 text-indigo-600 hover:text-white px-5 py-3 rounded-2xl shadow-xl transition-all font-bold group">
                            <span class="text-sm">Pending</span>
                            <i data-lucide="history" class="w-5 h-5"></i>
                        </a>
                        <a href="/sales-head/all-orders"
                            class="flex items-center gap-3 bg-white hover:bg-indigo-600 text-indigo-600 hover:text-white px-5 py-3 rounded-2xl shadow-xl transition-all font-bold group">
                            <span class="text-sm">All Orders</span>
                            <i data-lucide="list-checks" class="w-5 h-5"></i>
                        </a>
                        <a href="/sales-head/dashboard"
                            class="flex items-center gap-3 bg-white hover:bg-indigo-600 text-indigo-600 hover:text-white px-5 py-3 rounded-2xl shadow-xl transition-all font-bold group">
                            <span class="text-sm">Dashboard</span>
                            <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
                        </a>
                        <% } else if (userRole==='owner' ) { %>
                            <button
                                onclick="if(window.location.pathname === '/owner/dashboard') { switchDashboardView('activity') } else { window.location.href = '/owner/dashboard' }"
                                class="flex items-center gap-3 bg-white hover:bg-emerald-500 text-emerald-600 hover:text-white px-5 py-3 rounded-2xl shadow-xl transition-all font-bold group">
                                <span class="text-sm">Detailed View</span>
                                <i data-lucide="list-ordered" class="w-5 h-5"></i>
                            </button>
                            <button
                                onclick="if(window.location.pathname === '/owner/dashboard') { switchDashboardView('charts') } else { window.location.href = '/owner/dashboard' }"
                                class="flex items-center gap-3 bg-white hover:bg-purple-500 text-purple-600 hover:text-white px-5 py-3 rounded-2xl shadow-xl transition-all font-bold group">
                                <span class="text-sm">Analytics View</span>
                                <i data-lucide="pie-chart" class="w-5 h-5"></i>
                            </button>
                            <a href="/owner/reports"
                                class="flex items-center gap-3 bg-white hover:bg-indigo-600 text-indigo-600 hover:text-white px-5 py-3 rounded-2xl shadow-xl transition-all font-bold group">
                                <span class="text-sm">Reports</span>
                                <i data-lucide="bar-chart-2" class="w-5 h-5"></i>
                            </a>
                            <a href="/owner/dashboard"
                                class="flex items-center gap-3 bg-white hover:bg-indigo-600 text-indigo-600 hover:text-white px-5 py-3 rounded-2xl shadow-xl transition-all font-bold group">
                                <span class="text-sm">Dashboard</span>
                                <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
                            </a>
                            <% } else if (userRole==='headoffice' ) { %>
                                <button onclick="showSalespersonDetails(null, 'All Activity')"
                                    class="flex items-center gap-3 bg-white hover:bg-emerald-500 text-emerald-600 hover:text-white px-5 py-3 rounded-2xl shadow-xl transition-all font-bold group">
                                    <span class="text-sm">Detailed View</span>
                                    <i data-lucide="list-ordered" class="w-5 h-5"></i>
                                </button>
                                <a href="/headoffice/telecrm"
                                    class="flex items-center gap-3 bg-white hover:bg-purple-600 text-purple-600 hover:text-white px-5 py-3 rounded-2xl shadow-xl transition-all font-bold group">
                                    <span class="text-sm">TeleCRM</span>
                                    <i data-lucide="smartphone" class="w-5 h-5"></i>
                                </a>
                                <a href="/headoffice/dashboard"
                                    class="flex items-center gap-3 bg-white hover:bg-indigo-600 text-indigo-600 hover:text-white px-5 py-3 rounded-2xl shadow-xl transition-all font-bold group">
                                    <span class="text-sm">Dashboard</span>
                                    <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
                                </a>
                                <% } %>
        </div>

        <!-- Main FAB Button -->
        <button
            class="w-16 h-16 rounded-full bg-primary-600 text-white shadow-2xl flex items-center justify-center text-2xl transition-all duration-300 hover:scale-110 active:scale-95 z-[1001]"
            id="fabMain">
            <i data-lucide="plus" class="transition-transform duration-300 w-8 h-8" id="fabIcon"></i>
        </button>
    </div>
    <% } %>